%% ****** Start of file apstemplate.tex ****** %
%%
%%
%%   This file is part of the APS files in the REVTeX 4.2 distribution.
%%   Version 4.2a of REVTeX, January, 2015
%%
%%
%%   Copyright (c) 2015 The American Physical Society.
%%
%%   See the REVTeX 4 README file for restrictions and more information.
%%
%
% This is a template for producing manuscripts for use with REVTEX 4.2
% Copy this file to another name and then work on that file.
% That way, you always have this original template file to use.
%
% Group addresses by affiliation; use superscriptaddress for long
% author lists, or if there are many overlapping affiliations.
% For Phys. Rev. appearance, change preprint to twocolumn.
% Choose pra, prb, prc, prd, pre, prl, prstab, prstper, or rmp for journal
%  Add 'draft' option to mark overfull boxes with black boxes
%  Add 'showkeys' option to make keywords appear
\documentclass[aps,prl,twocolumn,groupedaddress]{revtex4-2}

% You should use BibTeX and apsrev.bst for references
% Choosing a journal automatically selects the correct APS
% BibTeX style file (bst file), so only uncomment the line
% below if necessary.
%\bibliographystyle{apsrev4-2}

\usepackage{graphicx}
\usepackage{epstopdf}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{color}
\usepackage{hyperref}
\usepackage{tikz}
\usepackage{mathrsfs}
\usepackage{wasysym}
\usepackage{tikz-cd}
\usepackage{adjustbox}
\usepackage{booktabs}
\usepackage{orcidlink}


% https://tex.stackexchange.com/questions/269553/counter-too-large-error-with-item
\usepackage{alphalph}
%\renewcommand\thesubsectiondis{\AlphAlph{\value{subsection}}.}% for the headings in the text
\renewcommand%\thesubsection{\mbox{\thesection-\AlphAlph{\value{subsection}}}}% for the ToC, for example   \renewcommand
\thesubsection{\mbox{\AlphAlph{\value{subsection}}}}% for the ToC, for example   

% so sections, subsections, etc. become numerated.
\setcounter{secnumdepth}{3}

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\newcommand{\avrg}[1]{\left\langle #1 \right\rangle}
\newcommand{\nelta}{\bar{\delta}}
\newcommand{\krn}{\mathrm{krn}}
\newcommand{\rng}{\mathrm{rng}}
\newcommand{\rnk}{\mathrm{rnk}}
\newcommand{\nll}{\mathrm{nll}}
\newcommand{\grad}{\mathrm{grad}}
\newcommand{\curl}{\mathrm{curl}}
\newcommand{\dive}{\mathrm{div}}
\newcommand{\bra}[1]{\left\langle #1\right|}
\newcommand{\ket}[1]{\left| #1 \right\rangle}
\newcommand{\sbra}[1]{\langle #1|}
\newcommand{\sket}[1]{| #1 \rangle}
\newcommand{\bek}[3]{\left\langle #1 \right| #2 \left| #3 \right\rangle}
\newcommand{\sbek}[3]{\langle #1 | #2 | #3 \rangle}
\newcommand{\braket}[2]{\left\langle #1 \middle| #2 \right\rangle}
\newcommand{\ketbra}[2]{\left| #1 \middle\rangle \middle\langle #2  \right|}
\newcommand{\sbraket}[2]{\langle #1 | #2 \rangle}
\newcommand{\sketbra}[2]{| #1 \rangle  \langle #2 |}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\snorm}[1]{\lVert#1\rVert}
\newcommand{\bvec}[1]{\boldsymbol{\mathsf{#1}}}
\newcommand{\bcov}[1]{\boldsymbol{#1}}
\newcommand{\bdua}[1]{\boldsymbol{\check{#1}}}
\newcommand{\bdov}[1]{\breve{#1}}
\newcommand{\bten}[1]{\boldsymbol{\mathfrak{#1}}}
\newcommand{\forany}{\tilde{\forall}}
\newcommand{\qed}{$\overset{\circ}{.}\;$}
\newcommand{\bigo}{\mathcal{O}}
\newcommand\scalemath[2]{\scalebox{#1}{\mbox{\ensuremath{\displaystyle #2}}}}

\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\CC}{\mathbb{C}}
\newcommand{\KK}{\mathbb{K}}
\newcommand{\FF}{\mathbb{F}}

\newcommand{\smallo}{o}

\begin{document}

% Use the \preprint command to place your local institutional report
% number in the upper righthand corner of the title page in preprint mode.
% Multiple \preprint commands are allowed.
% Use the 'preprintnumbers' class option to override journal defaults
% to display numbers if necessary
%\preprint{}

%Title of paper
\title{Analysis of the inference of ratings and rankings on Higher Order Networks with complex topologies}

% repeat the \author .. \affiliation  etc. as needed
% \email, \thanks, \homepage, \altaffiliation all apply to the current
% author. Explanatory text should go in the []'s, actual e-mail
% address or url should go in the {}'s for \email and \homepage.
% Please use the appropriate macro foreach each type of information

\author{Juan I. Perotti\,\orcidlink{https://orcid.org/0000-0001-7424-9552}}
\email[]{juan.perotti@unc.edu.ar}
\affiliation{Instituto de F\'isica Enrique Gaviola (IFEG-CONICET),\\
Facultad de Matem\'atica, Astronom\'ia, F\'isica y Computaci\'on,\\
Universidad Nacional de C\'ordoba, Ciudad Universitaria, 5000 C\'ordoba, Argentina}

%Collaboration name if desired (requires use of superscriptaddress
%option in \documentclass). \noaffiliation is required (may also be
%used with the \author command).
%\collaboration can be followed by \email, \homepage, \thanks as well.
%\collaboration{}
%\noaffiliation

\date{\today}

\begin{abstract}
The inference of rankings plays a central role in the theory of social choice, which seeks to establish preferences from collectively generated data, such as pairwise comparisons.
Examples include political elections, ranking athletes based on competition results, ordering web pages in search engines using hyperlink networks, and generating recommendations in online stores based on user behavior. 
Various methods have been developed to infer rankings from incomplete or conflicting data. One such method, HodgeRank, introduced by Jiang et al.~\cite{jiang2011statistical}, utilizes Hodge decomposition of cochains in Higher Order Networks to disentangle gradient and cyclical components contributing to rating scores, enabling a parsimonious inference of ratings and rankings for lists of items.
This paper presents a systematic study of HodgeRank's performance under the influence of quenched disorder and across networks with complex topologies generated by four different network models. The results reveal a transition from a regime of perfect trieval of true rankings to one of imperfect trieval as the strength of the quenched disorder increases. A range of observables are analyzed, and their scaling behavior with respect to the network model parameters is characterized. This work advances the understanding of social choice theory and the inference of ratings and rankings within complex network structures.
\end{abstract}

% insert suggested keywords - APS authors don't need to do this
%\keywords{}

%\maketitle must follow title, authors, abstract, and keywords
\maketitle

\section{Introduction}

The rating and ranking candidates, agents, items or options based on collectively expressed preferences is deeply ingrained modern human civilization, making the study of inference methods for ratings and rankings under diverse conditions highly significant.
Ratings and rankings are often derived from pairwise comparisons, which naturally form a network structure. 
Understanding how the topology of these networks influences the accuracy of rating and ranking inference is of critical importance.

The modern theory of ratings and rankings has its origins in the field of social choice, with early foundations laid in the late 13th century by Ramon Llull in his {\em Ars Electionis}~\cite{colomer2013ramon}. 
Llull's work introduced the concept of pairwise comparisons, the majority principle, and fairness in voting systems. 
Unfortunately, his contributions were largely forgotten over time. 
A mathematical revival of these ideas emerged in the late 18th century with the works of Borda and Condorcet~\cite{borda1781memoire,condorcet1785essai}, who laid the groundwork for modern voting and ranking theory. 
Later, in 1929, Zermelo proposed a model for ranking inference using ratings as latent variables within a probabilistic framework~\cite{zermelo1929berechnung}, but his work was also overlooked~\cite{newman2023efficient}. 
In the 1950s, Bradley and Terry reintroduced Zermeloâ€™s model in a broader context~\cite{bradley1952rank}. 
In the 1960s, a model based on similar principles was introduced and promoted by \'El\H{o}, eventually becoming the default rating system used by the World Chess Federation (FIDE)~\cite{elo1978rating}.
More recently, the advent of the World Wide Web and search engines highlighted the significance of network topology in ranking systems, exemplified by the success of PageRank, the original algorithm behind Google and introduced Brin and Page at the end of the 90's~\cite{brin1998anatomy}. 
The study of rating and ranking systems remains an active area of research~\cite{jiang2011statistical,csato2017ranking,debacco2018physical,newman2022ranking,jerdee2023luck}, as collective decision-making plays a vital role in modern civilization, particularly in the information age.

In 1736, Euler solved the Seven Bridges of K\"onigsberg problem, establishing the foundations of graph theory and foreshadowing the development of topology. 
Graphs, or networks, can be viewed as a specific type of topological space. 
Within the theory of Higher Order Networks~\cite{bianconi2021higher,battiston2021physics,majhi2022dynamics,bick2023what,ferraz2024contagion,muolo2024global,bianconi2024nature,bianconi2024theory}, hypergraphs extend the concept of graphs by incorporating hyperlinks, that may be used to represent many-body interactions or multiary-relations.
However, unlike graphs, hypergraphs are not necessarily topological spaces, as they may not satisfy the condition of topological closure. 
For example, a hypergraph may include a hyperlink $\{i,j,k\}$ without containing the link $\{i,j\}$. 
When hypergraphs satisfy the closure condition, they form a special class of topological spaces known as abstract simplicial complexes, or simply, simplicial complexes.

Although terminology and definitions may vary by context, many concepts from differential geometry on smooth manifolds can be adapted to the discrete or combinatorial setting of simplicial complexes~\cite{bobenko2008discrete,grady2010discrete,aygun2011spectral,tuncer2015spectral,rovelli2019natural,bianconi2021higher}.
Namely, discrete or combinatorial analogous of forms, gradients, divergences and Laplacians can be defined over simplicial complexes.
This is the reason for which simplicial complexes are often preferred over general hypergraphs.
In particular, and thanks to the property of topological closure, Hodge theory can be applied to decompose cochains over simplicial complexes into exact, coexact and harmonic components, much like the analogous decomposition of tensor fields~\cite{grady2010discrete,lim2020hodge}.
This is the approach followed by Jian et al.~\cite{jiang2011statistical} who developed HodgeRank, a method for the inference of ratings that leverages Hodge theory over simplicial complexes to disentangle different contributions to the inferred ratings.
The present article takes advantage of HodgeRank to study the inference of ratings and rankings in complex topologies~\cite{newman2018networks,perotti2009emergent}.
Section~\ref{sec:theory} provides an introduction to the theory of rating and ranking inference, and focuses on HodgeRank. Section~\ref{sec:results} presents the results of numerical experiments using HodgeRank applied to networks with complex topologies. 
Section~\ref{sec:discussion} discuss the results.
Section~\ref{sec:conclusions} summarizes the findings and outlines directions for future research. 

\section{
Theory
\label{sec:theory}
}

Several methods exist for inferring ratings and rankings from pairwise comparison data~\cite{jiang2011statistical}. This section focuses on a particular approach inspired by the foundational works of Zermelo~\cite{zermelo1929berechnung} and Bradley-Terry~\cite{bradley1952rank}, to illustrate how pairwise comparisons can be associated with probabilities that, in turn, relate to rating scores. These concepts are then used to introduce the HodgeRank method, followed by a discussion of the numerical challenges that arise within this framework.

Consider a set of $N=n+1$ items indexed by $i \in \{0, 1, \dots, n\}$. 
These items or agents could represent movies subject to pairwise comparison or even chess players competing in chess tournaments~\cite{perotti2013innovation}. 
For any two items $i$ and $j$, there exists a (possibly empty) sequence $s_{ij} = (s_{ij1}, s_{ij2}, \dots, s_{ijt}, \dots)$ of comparison results, where $s_{ijt} = -s_{jit}$ takes the value $1$, $0$, or $-1$ depending on whether option $i$ wins, draws, or loses the $t$-th comparison against option $j$, respectively. 
For example, these results could represent outcomes of chess games between players, or voting preferences over movies. 
Importantly, the set of non-empty sequences, or {\em pairings}, defines the links of an undirected network with $N$ nodes and no self-links, described by an adjacency matrix $a$ with entries $a_{ij} = a_{ji} \in \{0, 1\}$ for $i,j \in \{0, 1, \dots, n\}$. 
The degree, or the number of links adjacent to node $i$, is $k_i = \sum_j a_{ij} = \sum_j a_{ji}$, and the average degree is $\bar{k} = N^{-1} \sum_i k_i = 2M/N$, where $M = \frac{1}{2} \sum_{ij} a_{ij}$ is the total number of links.

Assuming that the results within a sequence are statistically independent and are identically distributed, the probability for a particular sequence to occur is 
\begin{eqnarray}
\label{eq:v_and_q}
P(s_{ij1},
...,s_{ijt},...)
&=&
P(s_{ij1})
...P(s_{ijt})...
\\
&=&
p_{ij}^{x_{ij}}q_{ij}^{y_{ij}}r_{ij}^{z_{ij}}
\nonumber
\\
&=&
v_{ij}^{x_{ij}}(1-v_{ij})^{z_{ij}}
q_{ij}^{y_{ij}}(1-q_{ij})^{x_{ij}+z_{ij}}
\nonumber
\end{eqnarray}
where $p_{ij}:=P(S_{ijt}=1)$, $q_{ij}:=P(S_{ijt}=0)$ and $r_{ij}:=P(S_{ijt}=-1)$, and $x_{ij}=\sum_t \delta_{s_{ijt},1}$, $y_{ij}=\sum_t \delta_{s_{ijt},0}$ and $z_{ij}=\sum_t \delta_{s_{ijt},-1}$ are the number of wins, draws and losses of $i$ over $j$ for all $t$, respectively.
Moreover, $v_{ij}:=P(S_{ijt}=1|S_{ijt}\neq 0)$ and $1-v_{ij}:=P(S_{ijt}=-1|S_{ijt}\neq 0)$ since $p_{ij}=v_{ij}(1-q_{ij})$ and $r_{ij}=(1-v_{ij})(1-q_{ij})$.
There are different ways to fit the probabilities of Eq.~\ref{eq:v_and_q} to given data.
For instance, in the maximum a posteriori bayesian approach of the multinomial distribution with a uniform prior, the expected value of the probabilities are $p_{ij}=(x_{ij}+1)/(x_{ij}+y_{ij}+z_{ij}+3)$, $q_{ij}=(y_{ij}+1)/(x_{ij}+y_{ij}+z_{ij}+3)$ and $r_{ij}=(z_{ij}+1)/(x_{ij}+y_{ij}+z_{ij}+3)$ and, therefore $v_{ij}=p_{ij}/(1-q_{ij})=(x_{ij}+1)/(x_{ij}+z_{ij}+2)$.
In this way, pairs of items with few comparisons can be handled appropriately.
In particular, if the kind of comparisons under consideration admit no draws, then $q_{ij}=0$ for all $ij$.

\subsection{
A rating method from least-squares
\label{sec:ratings_and_rankings_lsqr}
}

Consider the parameterization of the probabilities $v_{ij}$ in Eq.~\ref{eq:v_and_q} using the logistic function $v = (1 + e^f)^{-1}$. 
This defines a monotonically decreasing bijection between the probabilities $v_{ij} \in (0, 1)$ and the corresponding values $f_{ij} = \ln(v_{ij}^{-1} - 1) \in (-\infty, \infty)$, and motivates the following question.
{\em Is there a vector $w \in \mathbb{R}^N$ with components $w_i$ such that Eq.~\ref{eq:motivating_exact} is satisfied?}
\begin{equation}
\label{eq:motivating_exact}
f_{ij}=w_j-w_i
\end{equation}
If such a vector exists, it could serve as a rating system, where $v_{ij} > 1/2$ if and only if $f_{ij} < 0$, or equivalently, if and only if $w_j < w_i$. 
Additionally, this vector could be used to derive a ranking system, where a permutation $r_0, \dots, r_n$ of $0, 1, \dots, n$ satisfying $w_{r_0} \leq w_{r_1} \leq \dots \leq w_{r_n}$, yields a ranking $r_0, r_1, \dots, r_n$ of the items.
However, such a vector $w$ does not always exist. 
For example, a dataset might exhibit cyclic behavior, where item $i$ defeats $j$, $j$ defeats $k$, and $k$ defeats $i$, leading to inconsistencies in the ranking. 
Cyclical inconsistencies are common in practice.
Fortunatelly, a weakened version of Eq.~\ref{eq:motivating_exact} can still be used to infer useful ratings and rankings. 
Specifically, the exact condition of Eq.~\ref{eq:motivating_exact} can be replaced by the least-squares problem in Eq.~\ref{eq:motivating_lsqr}~\cite{csato2015graph}.
\begin{equation}
\label{eq:motivating_lsqr}
w = \argmin_{w'}
\sum_{ij} a_{ij}\,|f_{ij} - (w'_j-w'_i)|^2
\end{equation}
The idea here is that, although Eq.~\ref{eq:motivating_exact} cannot always be satisfied, the solution to Eq.~\ref{eq:motivating_lsqr} provides the vector $w$ that best approximates the intended behavior in a least-squares sense.

\subsection{HodgeRank}

In this section the HodgeRank method is reviewed~\cite{jiang2011statistical}.
For further reading, some practical applications of HodgeRank are demonstrated by Johnson et al.~\cite{johnson2013discrete} and some numerical challenges emerging from its appliation to complex networks are studied by Hirani et al.~\cite{hirani2015graph}.
Moreover, an elementary review about combinatorial differential topology, geometry and calculus over simplicial complexes is provided in the appendix section, where the formal details are introduced.

An hypergraph is composed of nodes, links and higher order links or hyperlinks such as triangles, tetrahedra and so on.
A simplicial complex is a specific type of hypergraph that satisfies the property of topological closure, making it a topological space. 
This structure allows for the definition of cochains, which are combinatorial versions of differential forms where scalar forms corresponds to 0-cochains, vector forms corresponds to 1-cochains and, more generally, $k$-forms corresponds to $k$-cochains.
In practical terms, a 0-cochain is a vector of scalars $w_i$ associated with nodes $i$, while a 1-cochain is a vector of antisymmetric scalars $f_{ij} = -f_{ji}$ associated with links $ij$. 
More generally, a $k$-cochain is a vector of alternating scalars $t_{i_0 \dots i_k}$ associated with hyperlinks known as $k$-simplices. 
Crucially, combinatorial versions of differential operators such as the gradient, the divergence, and the Laplacian, can be defined over simplicial complexes.
This framework allows the least-squares problem in Eq.~\ref{eq:motivating_lsqr} to be reformulated in terms of the 3-clique complex $K = K_0 \cup K_1 \cup K_2$, derived from the network of adjacency matrix $a$. 
Here, the values $f_{ij}$ are recognized as the components of a 1-cochain $f$, where $f_{ij} = -f_{ji}$ because $v_{ji} = 1 - v_{ij}$, while the differences $w_j - w_i$ correspond to the components of the gradient of a 0-cochain $w$.
More specifically, Eq.~\ref{eq:motivating_lsqr} can be rewritten as:
\begin{equation}
\label{eq:hodge_lsqr}
w=\argmin_{w'\in C_0^*}|f-d_0(w')|^2
\end{equation}
where $w \in C_0^*$ is a 0-cochain, and $d_0 = \grad$ is the gradient operator on the vector space $C_0^*$ of 0-cochains.
Thanks to this identification, the least-squares problem in Eq.~\ref{eq:hodge_lsqr} can be reformulated in terms of the Hodge decomposition of $f$. 

\begin{figure}
\includegraphics*[scale=.9]{assets/fig1.pdf}
\caption{
\label{fig:1}
(color online).
An elementary example of a simplicial complex with $N=8$ nodes.
Its set of 0-simplices or nodes is $K_0=\{\{0\},\{1\},...,\{7\}\}$, of 1-simplices or links is $K_1=\{\{0,1\},\{1,2\},\{0,2\},\{2,3\},\{3,4\},\{4,5\},\{1,5\},\{4,6\},\{6,7\}\}$ and of 2-simplices or triangles is $K_2=\{\{0,1,2\}\}$.
A local cyclic flow can only exists in the 2-simplex $\{0,1,2\}$ (depicted in green), while non-local cyclic flows can exists in the closed paths $1\to 2\to 3\to 4\to 5\to 1$ and $0\to 2\to 3\to 4\to 5\to 1\to 0$.
}
\end{figure}

In the Hodge decomposition of a general $k$-cochain $f \in C_k^*$, there exist unique $k$-cochains $s, g, h \in C_k^*$ such that $f = s \oplus h \oplus g$, where $s\in \rng\,d_{k}^*$, $h\in \krn\,L_k$ and $g\in \rng\,d_{k-1}$ are called the coexact, the harmonic and the exact components of $f$.
Here, $\rng\,d_{k}^*$, $\krn\,L_k$ and $\rng\,d_{k-1}$ are the ranges and kernel of the $k$-th dual coboundary operator $d_k^*$, the $k$-th Laplacian $L_k$ and the $(k-1)$-th coboundary operator $d_{k-1}$, respectively, and $C_k^*$ is the vector space of $k$-cochains.

To compute the Hodge decomposition of a $k$-chochain $f$, recall that
$\krn\,d_k=\krn\,L_k\oplus\,\rng\,d_{k-1}$
and 
$\krn\,d_{k-1}^*=\rng\,d_k^*\oplus\, \krn\,L_k$.
In consequence
\begin{eqnarray}
\label{eq:lsqr_u}
d_{k}(f) &=& d_{k}(s + h + g) \\
&=& d_{k}(s) \nonumber \\
&=& d_{k}(d_{k}^*(u)) \nonumber \\
&=& L_{k+1}^{\downarrow}(u) \nonumber \\
\alpha_{k+1} f &=& \alpha_{k+1} \alpha_{k+1}^T u \nonumber
\end{eqnarray}
and
\begin{eqnarray}
\label{eq:lsqr_w}
d_{k-1}^*(f) &=& d_{k-1}^*(s + h + g) \\
&=& d_{k-1}^*(g) \nonumber \\
&=& d_{k-1}^*(d_{k-1}(w)) \nonumber \\
&=& L_{k-1}^{\uparrow}(w) \nonumber \\
\alpha_{k}^T f &=& \alpha_{k}^T \alpha_{k} w. \nonumber
\end{eqnarray}
are singular linear equations for some $u \in C_{k+1}^*$ and $w \in C_{k-1}^*$, that can be solved to obtain $s = \alpha_{k+1}^T u$, $g = \alpha_{k} w$, and $h = f - s - g$.
Although the Hodge Laplacians 
$L_{k+1}^{\downarrow}$
and
$L_{k-1}^{\uparrow}$
are symmetric operators, they are also singular and, therefore, Eqs.~\ref{eq:lsqr_u} and \ref{eq:lsqr_w} still pose numerical challenges. 
Fortunately, these are the normal equations of respective least-squares problems. 
Hence, their singularities can be addressed by seeking the solutions $u$ and $w$ that also minimize the squared norms $|u|^2$ and $|w|^2$, respectively.

The Hodge decomposition provides a solution to Eq.~\ref{eq:hodge_lsqr} when $k=1$.
Namely, for $k=1$, any solution $w$ of Eq.~\ref{eq:lsqr_w} is also a solution to Eq.~\ref{eq:hodge_lsqr}, and vice versa. 
This approach to inferring $w$ from the Hodge decomposition of $f$ is what Jiang et al.~\cite{jiang2011statistical} referred to as {\em HodgeRank}. 
Additionally, drawing an analogy from physics in 3D, the coexact, harmonic, and exact components $s$, $h$, and $g$, are referred to as the solenoidal, harmonic, and gradient components of $f$, respectively, providing insightful observations in the context of rating inference.
Namely, the gradient component $g$ represents a non cyclic flow, which aligns perfectly with a rating vector $w$. 
In contrast, the solenoid and harmonic components, $s$ and $h$, correspond to local and non-local cyclic flows, respectively, which are incompatible with a consistent rating system.
See Fig.~\ref{fig:1} for an example.
These cyclic flows were previously discussed in Section~\ref{sec:ratings_and_rankings_lsqr}. 
The norms $|s|$, $|h|$, and $|g|$ help to gauge the extent to which the inferred ratings are affected by local or non-local cyclic flows.

\begin{figure*}
\includegraphics*[scale=.4]{assets/fig1.pdf}
\includegraphics*[scale=.4]{assets/fig1.pdf}
\put(-483,140){\bf a)}
\put(-240,140){\bf b)}
\\
\includegraphics*[scale=.4]{assets/fig1.pdf}
\includegraphics*[scale=.4]{assets/fig1.pdf}
\put(-483,140){\bf c)}
\put(-240,140){\bf d)}
\caption{
\label{fig:2}
(color online).
The mean of the average of the absolute differences of ratings $\avrg{\bar{\tau}}$ averaged over 5000 network samples and realizations of the disorder $\eta$ as a function of $\sigma$ for different sizes $N$ (left subpanels) and values of the parameter $\theta$ (right subpanels) of the corresponding network model.
Dashed lines represent guides to the eye.
In panel {\bf a)}, 1D-lattices where $\theta=z$ is the number of neighbors per node.
In panel {\bf b)}, Erd\H{o}s-R\'enyi random networks where $\theta=\bar{k}$ is the average degree.
In panel {\bf c)}, Barab\'asi-Albert scale-free networks where $\theta=q$ is the number of new links for each new node of the growing algorithm.
In panel {\bf d)}, Watts-Strogatz small-world networks of average degree $\bar{k}=4$ where $\theta=p$ is randomization probability per link.
In the inset, the value of $\avrg{\bar{\tau}}$ for fixed $\sigma$ is plotted as a function of $p$.
}
\end{figure*}

In practice, some components $w_i$ of the minimum norm solution to Eq.~\ref{eq:lsqr_w} may be negative. 
Since a rating system with non-negative ratings is often desirable, the components can be shifted by a constant term, $w_i \to w_i - \min_j w_j$. 
This shifted rating vector remains a valid solution to Eqs.~\ref{eq:hodge_lsqr} and facilitates the comparison between the inferred $w$ and the true ratings $\hat{w}$ when the later are available.

\section{
Results
\label{sec:results}
}

In the following numerical experiments, HodgeRank is applied to infer the ratings and rankings of items matched by networks of various topologies: 1D-lattices, ErdÅ‘s-RÃ©nyi (ER) random graphs, BarabÃ¡si-Albert (BA) scale-free networks, and Watts-Strogatz (WS) small-world networks~\cite{newman2018networks}.

For each network of adjacency matrix $a$, a vector of true ratings $\hat{w}$ is generated according to $\hat{w}_i = i$ for $i = 0, 1, \dots, n$. 
With this choice, the expected true ranking is $\hat{r}_i=i$.
In 1D-lattices and WS networks, nodes are enumerated following the natural order in the lattice and in BA networks nodes are enumerated from the oldest to the newest.
Using the true rating vector $\hat{w}$, a corresponding 1-cochain $f$ is defined by
\begin{equation}
\label{eq:f_and_eta}
f_{ij}
=
\hat{w}_j-\hat{w}_i
+
\eta_{ij},
\end{equation}
where the different components of the 1-cochain $\eta$ are independent and identically distributed random variables drawn from a Gaussian distribution with zero mean and standard deviation $\sigma$. 
Equation~\ref{eq:f_and_eta} is similar to Eq.~\ref{eq:motivating_exact}, but includes the contribution of the additive quenched disorder characterized by $\eta$ that models the effect of statistical fluctuations and the cyclic flows captured by the components $s$ and $h$ of $f$.
When $\sigma = 0$, the inferred ratings are expected to be perfectly aligned with the true ratings, but as $\sigma$ increases, discrepancies are likely to emerge.

\begin{figure*}
\includegraphics*[scale=.4]{assets/fig1.pdf}
\includegraphics*[scale=.4]{assets/fig1.pdf}
\put(-483,140){\bf a)}
\put(-240,140){\bf b)}
\\
\includegraphics*[scale=.4]{assets/fig1.pdf}
\includegraphics*[scale=.4]{assets/fig1.pdf}
\put(-483,140){\bf c)}
\put(-240,140){\bf d)}
\caption{
\label{fig:3}
(color online).
The mean of the average of the absolute differences of rankings $\avrg{\bar{\tau}}$ as a function of $\sigma$ for the same numerical experiments of Fig.~\ref{fig:2}.
The insets zoom-in certain regions of the main plots.
Dashed lines represent guides to the eye.
}
\end{figure*}


To compare the true ratings $\hat{w}_i$ with the inferred ratings $w_i$, as well as the true rankings $\hat{r}_i$ with the inferred rankings $r_i$, the average absolute differences
$$
\tau
=
\frac{1}{N}
%\sum_{j:j\leq i}
\sum_{i}
|\hat{w}_i-w_i|
$$
and
$$
\rho
=
\frac{1}{N}
%\sum_{j:j\leq i}
\sum_{i}
|\hat{r}_i-r_i|
$$
are used, respectively.
These metrics are zero when the inferred ratings or rankings match the true ones, and greater than zero otherwise.
It is important to note that the means $\bar{\tau}(\sigma, a) = \int dw \, P(w | \sigma, a) \, \tau(w)$ and $\bar{\rho}(\sigma, a) = \int dw \, P(w | \sigma, a) \, \rho(w)$, while similar to order parameters, are more accurately described as {\em disorder parameters}, since they become different from zero when disorder kicks in. 
Here, the distribution $P(w | \sigma, a)$ represents the statistics of $w$ obtained from solving Eq.~\ref{eq:hodge_lsqr} while sampling $\eta$ for a given network structure $a$.
In the experiments, the network-averaged quantities, $\langle \bar{\tau} \rangle (\sigma) = \sum_a P(a | N, \theta) \bar{\tau}(\sigma, a)$ and $\langle \bar{\rho} \rangle (\sigma) = \sum_a P(a | N, \theta) \bar{\rho}(\sigma, a)$, are computed, where $N$ and $\theta$ represent relevant parameters of the network models. 
Specifically, $\theta$ denotes the coordination number $z$ for 1D-lattices, the average degree $\bar{k}$ for ER networks, the number of new links $q$ per new node in BA networks, and the fraction $p$ of randomized links for WS networks with average degree $\bar{k}=4$.

Traditional solvers struggle to provide adequate solutions for Eqs.~\ref{eq:lsqr_u} and~\ref{eq:lsqr_w}. 
To address this, the recently introduced iterative solver \verb+MINRES-QLP+, developed by Choi et al.~\cite{choi2011minresqlp}, is employed to find the minimum norm solutions to the singular least-squares problems. 
This solver is available in the \verb+Krylov.jl+ package~\cite{montoison2023krylov} for the Julia programming language~\cite{bezanson2017julia}. 
A Jupyter notebook with the code used for the experiments can be found online~\cite{github_hon_ranking}.
The performance of \verb+MINRES-QLP+ was evaluated on non-periodic 1D-lattices of varying sizes $N$. 
For $\sigma = 0$, the solver demonstrates satisfactory numerical accuracy for network sizes up to approximately $N \approx 10^5$. 
However, to mitigate the impact of numerical errors, subsequent experiments are conducted on networks of considerably smaller sizes.

The following figures contain four panels, each corresponding to a different network model.
In each figure, panel {\bf a)} presents results for non-periodic 1D-lattices, panel {\bf b)} for ER networks, panel {\bf c)} for BA networks and panel {\bf d)} for WS networks.
Furthermore, each panel is divided into two subpanels.
The left subpanel presents results for $\theta$ fixed and varying network sizes $N$, and the right subpanel for fixed $N$ and varying $\theta$.
The results are averaged over 5000 samples of both $a$ (the network structure) and $\eta$ (the disorder).
Where possible, a phenomenologically obtained approximate scaling relation for the studied quantities is indicated.

In Fig.~\ref{fig:2}, the mean of the average absolute differences, $\avrg{\bar{\tau}}$, between true and inferred ratings is plotted as a function of $\sigma$. 
For small $\sigma$, an approximately linear scaling of $\avrg{\bar{\tau}}$ with $\sigma$ is observed in most cases. 
However, deviations from this behavior emerge and are more pronounced in networks with smaller sizes $N$ or average degrees $\bar{k}$, specially in BA networks.
As shown in the left subpanels, $\avrg{\bar{\tau}}$ scales approximately as $\sim N^{1/2}$ for 1D-lattices, while for all other network models, it appears largely independent of $N$. 
In the right subpanels, it is observed for 1D-lattices that $\avrg{\bar{\tau}}$ scales as $\sim z^{-1.3}$ for sufficiently large values of $z$. 
Similarly, it scales as $\sim \bar{k}^{-2/3}$ for ER networks and $\sim q^{-2/3}$ for BA networks. 
In all cases, deviations from these scalings are observed when networks approach a sparse tree-like structure.
For WS networks, $\avrg{\bar{\tau}}$ decreases with $\ln p$ in a sigmoid-like manner, as shown in the inset of the right subpanel of panel {\bf d)}, where the transition point is found between the small-world and the lattice regimes.

In Fig.~\ref{fig:3}, the mean of the average absolute differences, $\avrg{\bar{\rho}}$, between true and inferred rankings is shown as a function of $\sigma$. 
Interestingly, as it can be seen in more detail in the insets, two distinct regimes are observed.
For small values of $\sigma$, there is a region of perfect retrieval of the true ranking, where $\avrg{\bar{\rho}} = 0$. 
This behavior persists up to a non-trivial threshold, $\sigma^*$, after which $\avrg{\bar{\rho}}$ deviates from zero increasing monotonically with $\sigma$.
As seen in the right subpanels of panels {\bf a)}, {\bf b)}, and {\bf c)}, a transition region emerges in networks with a sufficiently large connectivity, $\bar{k}$. 
In this region, $\avrg{\bar{\rho}}$ shifts from perfect retrieval to a regime where it grows approximately linearly with $\sigma$.
The distinction between these two regimes becomes more pronounced with increasing disorder in the network structure, as illustrated by the WS networks in the right subpanel of panel {\bf d)} as $p$ grows.

To identify a transition point $\sigma_c$ within a transition region, the primitive
$$
\avrg{\bar{\rho}}(\sigma)
=
\frac{A}{B}
\ln
\big(
1+e^{B(\sigma-\sigma_c)}
\big)
$$
of the sigmoid function
$$
\avrg{\bar{\rho}}'(\sigma)
=
\frac{A}{1+e^{-B(\sigma-\sigma_c)}}
$$
is fitted to the curves of Fig.~\ref{fig:3}.
Here, $A$, $B$ and $\sigma_c$ are fitting parameters.
The primitive function approaches linear growth, $\avrg{\bar{\rho}}(\sigma) \approx A(\sigma - \sigma_c)$, for $\sigma \gg \sigma_c$, and approaches zero for $\sigma \ll \sigma_c$. 
The parameter $B^{-1}$ controls the width of the transition region.
The peak of the derivative of the sigmoid function
$$
\avrg{\bar{\rho}}''(\sigma)
=
\frac{ABe^{-B(\sigma-\sigma_c)}}{(1+e^{-B(\sigma-\sigma_c)})^2}
$$
determines the transition point $\sigma_c$. 
The range $[\sigma^*,\sigma^{**}]$ of fitted values for each curve is determined by maximizing the height of the peak, $\avrg{\tilde{\rho}}:=\avrg{\bar{\rho}}''(\sigma_c) = \frac{AB}{4}$, as a function $\sigma^{**}$.
Further details of the fitting procedure can be found in Figs.~1-8 and related text of the Supplemental Material (SM) at~[URL will be inserted by publisher].
The results of these fits are shown in Fig.~\ref{fig:4}, where the transition points $\sigma_c$ and peak heights $\avrg{\tilde{\rho}}$ are plotted as functions of the networks' parameters $N$ and $\theta$.
As seen in the left subpanels, the dependency of these quantities on the network size $N$ is negligible or relatively weak for all network models. 
In contrast, the right subpanels reveal different power-law scalings between these quantities and $\theta$ for the different networks models and $N$ fixed.
More specifically, $\sigma_c$ grows with $z$, $\bar{k}$ and $q$ for 1D-lattices, ER and BA networks, respectively.
In particular, the scaling law has a logarithmic correction for ER networks.
On the other hand, the peak heigth $\avrg{\tilde{\rho}}$ decreases with $z$, $\bar{k}$ and $q$.
For WS networks, both $\sigma_c$ and $\avrg{\tilde{\rho}}$ remain approximately constant in the small-world regime, but undergo a sharp change once the lattice regime is reached.

\begin{figure*}
\includegraphics*[scale=.4]{assets/fig1.pdf}
\includegraphics*[scale=.4]{assets/fig1.pdf}
\put(-483,140){\bf a)}
\put(-240,140){\bf b)}
\\
\includegraphics*[scale=.4]{assets/fig1.pdf}
\includegraphics*[scale=.4]{assets/fig1.pdf}
\put(-483,140){\bf c)}
\put(-240,140){\bf d)}
\caption{
\label{fig:4}
(color online).
Transition points $\sigma_c$ (green circles) and peak heights $\langle \tilde{\rho} \rangle$ (pink stars) obtained from fits of the primitives of sigmoid functions to the curves $\langle \bar{\rho} \rangle$ vs. $\sigma$ in Fig.~\ref{fig:3}.
Error bars are calculated through error propagation of the errors of the fitted parameters.
The dashed lines represent phenomenological scaling relations fitted to the data points.
}
\end{figure*}

\section{
Discussion
\label{sec:discussion}
}

The scaling of $\avrg{\bar{\tau}}$ vs $N$ indicated in Figs.~\ref{fig:2} for the 1D-lattice differs from the observed in the other network models.
This suggests that the non-local cycles existing in the small-world regime affects the inference of ratings.
The observation is consistent with the behavior of $\langle \bar{\tau} \rangle$ with $\ln p$ in the WS model.
Concerning the scaling of $\langle \bar{\tau} \rangle$ with $z$, $\bar{k}$, and $q$, deviations from such scalings become evident as the networks approach a sparse tree-like regime, where the lack of redundant paths weakens the reinforcement of rating differences between arbitrary items.

The results suggest that the transition from a regime of perfect retrieval $\avrg{\bar{\rho}}=0$ to a regime of partial retrieval $\avrg{\bar{\rho}}>0$ of the true ratings observed in Fig.~\ref{fig:3}, is a consequence of the progressive degradation of the rating differences as the strength $\sigma$ of the quenched dissorder increases.
Namely, this interpretation is supported by the fact that $\avrg{\bar{\tau}}$, $|h|$ and $|s|$ grow almost linearly with $\sigma$ as shown in Fig.~\ref{fig:2} and Figs.~10~and~11 of the SM.
For sufficiently large connectivities, the transition region remains bounded and is approximately defined by $[\sigma^*, \sigma^{**}]$, with a transition point $\sigma_c$ identified by the peak of the primitive of a sigmoid function. 
As connectivity decreases, or as the small-world property weakens with decreasing $p$, the transition region becomes less definite, emphasizing the critical role that redundant non-local paths have in establishing a well-defined ranking.
Finally, Fig.~\ref{fig:4} shows that the properties of the transition are weakly dependent on network size but strongly influenced by the characteristics of the network model and the values of its other parameters.
This observation is further supported by the scaling of the functions defined by $|f|$, $|s|$, $|h|$ and $|g|$ versus $\sigma$, across the different network models, shown for varying $N$ with fixed $\theta$ and varying $\theta$ with fixed $N$ in Figs.~9-12 of the SM.
Additionally, for the sake of completion, scaling relations for the average number of dimensions $\avrg{\kappa_k}$ of the vector spaces $C_k$ of $k$-chains are also shown in Fig.~13 of the SM, and are consistent with the observed behavior for $|s|$ and $|h|$.

\section{
Conclusions
\label{sec:conclusions}
}

This work explores the impact of complex network topologies on the performance of {\em HodgeRank}, a method developed to infer ratings from pairwise comparisons using a combinatorial formulation of differential geometry and Hodge theory over Higher Order Networks. 
The study presents a comprehensive scaling analysis of a variety of metrics, using well-established network models: 1D-lattices, ErdÅ‘s-RÃ©nyi random graphs, BarabÃ¡si-Albert scale-free networks, and Watts-Strogatz small-world networks. 
Additionally, the analysis incorporates the effects of quenched disorder in the data, which negatively influences the inference of ratings and rankings.
The numerical experiments demonstrate that as the strength of disorder varies, a transition occurs from a regime of perfect retrieval to one of partial retrieval of the true rankings.
The scaling laws identified for the different studied quantities, highlight the critical role of the network structure.
This variability encompasses contributions from both the gradient and cyclic flows of the Hodge decomposition that form the foundation of the HodgeRank method.

Future work could apply more traditional methods from statistical physics to further investigate the properties of the mentioned transition and scaling relations. 
Additionally, this approach could be extended to study the inference of ratings and rankings in empirical data, potentially leading to the development of more realistic models of the network topology and the quenched disorder.
Moreover, future work could study how the quenched disorder affects the inferred ratings and rankings of the individual nodes depending on their local properties.
Finally, using the benchmark experiments here developed, it would be interesting to investigate how HodgeRank compares with alternative methods for the inference of ratings and rankings over a broader range of network models, using modern computer architectures like GPUs or over very large datasets.

\begin{acknowledgments}
The author acknowledges partial support from CONICET under grant PIP2021-2023 number 11220200101100, and from SeCyT (Universidad Nacional de CÃ³rdoba, Argentina). Special thanks go to O.V. Billoni for a careful reading of the article, and to the Centro de CÃ³mputo de Alto DesempeÃ±o (CCAD) at the Universidad Nacional de CÃ³rdoba (UNC), \url{http://ccad.unc.edu.ar/}, which is part of SNCAD â€“ MinCyT, Argentina, for providing computational resources.
\end{acknowledgments}

% Create the reference section using BibTeX:
\bibliography{ref}

% Specify following sections are appendices. Use \appendix* if there
% only one appendix.

\appendix*
\onecolumngrid

\section{\label{appA}Combinatorial differential topology, geometry and calculus}

This section provides an introductory review about combinatorial differential topology, geometry and calculus over simplicial complexes. 
Where appropriate, analogies to the smooth standard version of differential geometry over manifolds are highlighted. 
However, it is important to remark that, despite these similarities, significant differences exits between the combinatorial and smooth frameworks~\cite{ribando2023combinatorial}.

\subsection{Notation}

If  $\{e_i:i\in I\}$ is a basis of a vector space $V$ over a field $\FF$, then the linear decomposition of a vector $v\in V$ is denoted by $v=v^ie_i$ where Einstein's summation convention is assumed and $v^i\in \FF$.
Additionally, if $f\in V^*$ is a covector of the dual vector space of $V$, then $f=f_ie^i$ where $\{e^i:i\in I\}$ is the corresponding dual basis, $f_i\in \FF$ is a coordinate and $e^i(e_j)=\delta^i{}_j$ is Kronecker's delta.
If $a:V\to V$ is a linear operator, then there is a matrix of components $a_i{}^j$ such that $a(e_i)=a_i{}^je_j$.
In this way, $w^je_j=w=a(v)=v^ia(e_i)=v^ia_i{}^je_j$, so $w^j=v^ia_i{}^j=(a^T)^j{}_iv^i$ where $(a^T)^j{}_i$ are the components of the transpose of the matrix of components $a_i{}^j$~\footnote{The first index $i$ of the components $a_{ij}$, $a^{ij}$, $a_i{}^j$ and $a^i{}_j$ of a matrix indicates the row of the entry, while the second $j$ the column. 
There is no predefined relation between the left/right and the upper/lower properties of an index.}.
The kernel of $a$ is denoted by $\krn\,a=\{v\in V:a(v)=0\}$, the range is denoted by $\rng\,a=a(V)=\{a(v):v\in V\}$, the null is denoted by $\nll\,a=\dim\,\krn\,a$ and the rank is denoted by $\rnk\,a=\dim\,\rng\,a$.
An inner product over $V$ maps any two vectors $u,v\in V$ into a scalar $u.v\in \FF$.
It is linear in the first argument if $\FF=\RR$ or antilinear if $\FF=\CC$, and always linear in the second argument.
Moreover, $v.v\geq 0$ for all $v\in V$, so $|v|:=\sqrt{v.v}$ is a norm over $V$ and, in particular, $v.v=0$ implies $v=0$ whenever the inner product is non-degenerate.

\subsection{Simplicial complexes}

An abstract simplicial complex is a set $K$ of subsets of $\{0,1,...,n\}$ that satisfies the property of topological closure: i.e. if $s\in K$ and $r\subseteq s$ is non-empty, then $r\in K$.
The elements $i$ of $\{0,1,...,n\}$ are called nodes.
The elements of $K$ are called simplices.
For each simplex $s\in K$, there exist unique $i_0,...,i_k$ in $\{0,1,...,n\}$ such that $s=\{i_0,i_1,...,i_k\}$ and $i_0<i_1<...<i_k$.
Here, $\dim s=k=|s|-1$ is called the dimension of the simplex $s$ and $\dim K := \max_{s\in K} \dim\, s$ is the dimension of the complex $K$.
Correspondingly, $s$ is called a $k$-simplex and $K$ a $(\dim K)$-complex.
$K_k$ denotes the set of all $k$-simplices in $K$ and its cardinality is $\kappa_k:=|K_k|$, while $\kappa:=\sum_k\kappa_k=|K|$ is the cardinality of the complex $K$.
In particular, $K_{-1}=K_{n+1}=\emptyset$ are defined for convenience.
For any different nodes $i,j,k,l \in \{0,1,...,n\}$, 0-simplices like $\{i\}$ are in one to one correspondence with nodes, 1-simplices like $\{i,j\}$ can be thought of links, 2-simplices like $\{i,j,k\}$ as triangles, 3-simplices like $\{i,j,k,l\}$ as tetrahedra, and so on.
In particular, a simplicial complex of dimension $\dim K=1$ is equivalent to a non-directed graph without self-links.

A simplex $r$ is a face of another $s$ if $r\subset s$.
There are ${k + 1 \choose q + 1}$ $q$-faces within a $k$-simplex.
Moreover, $r$ is a facet of $s$ if $r\subset s$ and $1+\dim\,r=\dim\,s$.
Correspondingly, $s$ is a coface/cofacet of $s$ if $r$ is a face/facet of $s$, respectively.
Additionally, $r$ and $s$ are incident to each other if $r$ is a facet of $s$ or $s$ is a facet of $r$.
Furthermore, $r$ and $s$ are lower-adjacent to each other if they have a facet in common, and are upper-adjacent to each other if they are both different facets of a common simplex.
In particular, two vertices of a common graph are upper-adjacent if they are both different facets of a common edge.
The degree $k_s$ of a simplex $s$ is its number of cofacets.
The degree $k_s$ of a simplex $s$ should not be confused with the dimension $k$ of a $k$-simplex.
The generalized degree $\zeta_{sq}$ of a $k$-simplex $s$ is its number of $q$-cofaces.
In the particular case of common graphs or networks, $k_i=\zeta_{i1}$ for any node $i$.

A simplicial complex $K$ can be obtained from a graph $g$ where each $(k+1)$-clique of $g$ corresponds to a $k$-simplex of $K$.
Such simplicial complex obtained from $g$ is called the {\em clique complex} of $g$.
In particular, the $(k+1)$-clique complex of a graph $g$ is the simplicial complex obtained by considering only the $(q+1)$-cliques of $g$ for $q\leq k$.

\subsection{Chains}

The set of functions from $K$ to some number field $\FF$ is a vector space $C$ of vectors called chains.
The functions $e_s : K\to \FF$ for $s\in K$ such that $e_s(r)=\delta_{sr}$ form a canonical basis of $C$~\footnote{Here, $\delta_{sr}$ is the Kronecker delta.}.
In particular, if $s$ is a $k$-simplex, then $e_s$ is called a $k$-chain.
The subset of linear combinations of $k$-chains form a subspace $C_k$ of $C$.
Crucially,
$$
C=C_0\oplus C_1\oplus ... \oplus C_n
$$
where $C_0=C_n\cong\FF$, i.e. $C_0$ and $C_n$ are isomorphic to $\FF$.
For convenience, $C_{-1}=C_{n+1}=\{0\}$ are also defined.
Note, $m_k=\dim\, C_k\leq {n\choose k}$ for $k=0,1,...,n$, and $\dim\, C_{-1}=\dim\, C_{n+1}=0$. 
Therefore, $\dim\,C\leq \sum_{k=0}^n {n\choose k}=2^n$.
Using Einstein's notation, any chain of $C$ can be represented by a linear combination $c=c^se_s$ with unique coefficients $c^s\in \FF$.

\subsection{Cochains}

The dual space $C^*$ of $C$ is called the vector space of cochains of $K$.
If $C_k^*$ is the dual space of $C_k$, then
$$
C^*=C_0^*\oplus C_1^*\oplus ... \oplus C_n^*
$$
For convenience, $C_{-1}^*=C_{n+1}^*=\{0\}$ are also defined.
The covectors in $C_k^*$ are called $k$-cochains.
In particular, $\{e^s:s\in K\}$ denotes the basis of $C^*$ dual to the canonical basis $\{e_s:s\in K\}$ of $C$.
As a consequence, $e^s(e_r)=\delta^s{}_r$ for all $s,r\in K$.
In this way, any cochain $f\in C^*$ can be represented by a linear combination $f=f_se^s$ of coefficients $f_s\in \mathbb{F}$.

The application of a cochain $f$ to a chain $c$ equals $f(c)=f_se^s(c^re_r)=f_sc^re^s(e_r)=f_sc^r\delta^s{}_r=f_sc^s\in \FF$.
In a sense, $f(c)$ is the combinatorial analogous of the integration $\int_c f$ of form $f$ over a manifold $c$.
It should be remarked, however, that a simplicial complex is not always obtained from the discretization of a manifold.
This is the reason for which, in this work, the term {\em combinatorial} is preferred over the term {\em discrete}.

\subsection{Orientation}

Let $e_{i_0i_1...i_k}:=e_{\{i_0,i_1,...,i_k\}}$ when $0\leq i_0<i_1<...<i_k\leq n$.
Otherwise, let 
$$
e_{j_0j_1...j_k}
=
\left\{
\begin{array}{rl}
e_{i_0i_1...i_k} & \mbox{if $j_0j_1...j_k$ is an even permutation of $i_0i_1...i_k$,} \\
-e_{i_0i_1...i_k} & \mbox{if it is an odd permutation, and} \\
0 & \mbox{otheriwse.}
\end{array}
\right.
$$
The sign between $e_{j_0j_1...j_k}$ and $e_{i_0i_1...i_k}$ is called the orientation of $e_{j_0j_1...j_k}$ relative to $e_{i_0i_1...i_k}$.
Like the orientation of the axis of $\RR^n$, the orientation of the simplices is a matter of convention, which is consisten with the arbitrariness in the enumeration of the nodes.

\subsection{
Boundaries
\label{sec:boundaries}
}

The boundary operator over chains $\partial : C\to C$ is defined by
$$
\partial = \partial_0+\partial_1+...+\partial_n
$$
where $\partial_{-1}=\partial_0=\partial_{n+1}=0$, and
$$
%\partial_k(e_s)
\partial_k(e_{i_0i_1...i_q})
=
\delta_{qk}
\sum_{j=0}^q
(-1)^j 
e_{i_0i_1...\hat{i}_j...i_k}
$$
for $0<k\leq n$, where $e_{i_0i_1...\hat{i}_j...i_k}:=e_{i_0i_1...i_{j-1}i_{j+1}...i_k}$.
Here, the sign of $(-1)^j$ is called the orientation that the $k$-chain $e_{i_0i_1...i_k}$ induces on the $(k-1)$-chain $e_{i_0i_1...\hat{i}_j...i_k}$.

The boundary operator satisfies the following crucial properties.
Firstly, $\partial$ is a linear operator.
Secondly, $\partial_k(C)=\partial(C_k)\subseteq C_{k-1}$, meaning that the boundary of a simplex of dimension $k$ has dimension $k-1$.
Thirdly, $\partial^2=0$, meaning that a boundary has no boundary.
This third statement follows from
$$
\partial^2 
=
\sum_{jk}\,
\partial_j \partial_k
\nonumber
\\
=
\sum_{k}\,
\partial_{k}\partial_{k+1}
$$
and the fact that $\partial_{k}\partial_{k+1}=0$ follows from the alternating definition of $\partial_k$ and that chains are oriented.

In matricial form 
$\partial_k(e_s)=(\alpha_k)_s{}^r e_r$.
In this way, $q^re_r=q=\partial_k(c)=\partial_k(c^se_s)
=c^s\partial_k(e_s)=c^s(\alpha_k)_s{}^re_r$.
Hence, $q^r=c^s(\alpha_k)_s{}^r=(\alpha_k^T)^r{}_sc^s$.
Note, $(\alpha_k)_s{}^r\neq 0$ if and only if $s$ and $r$ are incident to each other.
Hence, $\alpha_k\in \RR^{m_{k}\times m_{k-1}}$ or its transpose $\alpha_k^T$ are usually called the $k$-th incidence matrix of the simplicial complex~\cite{grady2010discrete,newman2018networks,bianconi2021higher}.
In this work, the convention where the incidence matrix is the transpose $\alpha_k^T$ is adopted.

\subsection{Coboundaries}

The coboundary operator $d:C^*\to C^*$ is the combinatorial analogous of the differential operator.
It is defined by
$$
(d(f))(c) = f(\partial(c))    
$$
for all $f\in C^*$ and $c\in C$, which can be recognized as the combinatorial analogous of the generalized Stoke's theorem
$$
\int_c df = \int_{\partial c} f
$$
which in turn is the generalization of the fundamental theorem of calculus to arbitrary dimensions.
Crucially, 
$$
d=d_0+d_1+...+d_n
$$
where $d_{-1}=d_n=d_{n+1}=0$,  $d_k(C^*)=d(C_k^*)\subseteq C_{k+1}^*$,
and $(d_k(f))(c)=f(\partial_{k+1}(c))$ for all $c\in C$.
Moreover, $d^2=0$ and $d_k d_{k-1}=0$ easily follows from $\partial^2=0$.
This fact is the reason for which many differential equations in physics are of second order.

In matricial form 
$d_k(e^s)=(\beta_k)^s{}_r e^r$.
Hence, 
\begin{eqnarray}
(d_k(e^s))(e_r)
&=&
e^s(\partial_{k+1}(e_r))
\nonumber
\\
((\beta_k)^s{}_te^t)(e_r)
&=&
e^s((\alpha_{k+1})_r{}^le_l)
\nonumber
\\
(\beta_k)^s{}_t\,e^t(e_r)
&=&
(\alpha_{k+1})_r{}^l\,e^s(e_l)
\nonumber
\\
(\beta_k)^s{}_t\,\delta^t{}_r
&=&
(\alpha_{k+1})_r{}^l\,\delta^s{}_l
\nonumber
\\
(\beta_k)^s{}_r
&=&
(\alpha_{k+1})_r{}^s
\nonumber
\end{eqnarray}
In other words, $\beta_k=(\alpha_{k+1}^T)$.
Note, $g_re^r=g=d_k(f)=d_k(f_se^s)=f_sd_k(e^s)
=f_s(\beta_k)^s{}_re^r$.
Hence $g_r=f_s(\beta_k)^s{}_r=(\beta_k^T)_r{}^sf_s=(\alpha_{k+1})_r{}^sf_s$.

Note, $\grad = d_0:C_0^*\to C_1^*$ and 
$\curl = d_1:C_1^*\to C_2^*$ are recognized as a combinatorial analogous of the gradient and the curl operators of standard differential calculus~\footnote{Strictly speaking, in standard differential calculus, the gradient operator is defined in a way that is metric dependent.}, respectively.
In particular, the known result $\curl\circ\grad=-d_1 d_0=0$ follows as a particular case of $d_k d_{k-1}=0$.
As an example on how these operators work, note that if $f\in C_0^*$ and $g=\grad\, f=d_0(f)$, then $g_{ij}=g(e_{ij})=(d_0(f))(e_{ij})=f(\partial_1(e_{ij}))=f(e_j-e_i)=f_j-f_i$.

\subsection{Inner products and geometry}

Consider a positive definite inner product from $C$ to $\RR$.
By the Riesz's representation theorem, a positive definite inner product over $C$ induces an isomorphism $C\ni c\to c^{\flat}\in C^*$ called {\em flat} defined by
$$
c^{\flat}(q) = c.q
$$
for all $c,q\in C$.
Its inverse is denoted by $C^*\ni f\to f_{\sharp}\in C$ and is called {\em sharp}.
Together, $\flat$ and $\sharp$ are called musical isomorphisms.
They induce a positive definite inner product over $C^*$ given by $f.g = f_{\sharp}.g_{\sharp}$ for all $f,g\in C^*$.

Consider a non-degenerate inner product over $C$.
Its coordinates in the canonical basis are $m_{sr}=e_s.e_r=e_r.e_s=m_{rs}$ for $s,r\in K$.
Since $e_s^{\flat}\in C^*$, there exists $t_{sr}\in \RR$ such that $e_s^{\flat}=t_{sr}e^r$ and, therefore,
$$
m_{sq} = e_s.e_q = e_s^{\flat}(e_q)=t_{sr}e^r(e_q)=t_{sr}\delta^r{}_q=t_{sq}
$$
In consequence
$$
m_{sr}=e_s.e_r=e_s^{\flat}.e_r^{\flat}=(m_{st}e^t).(m_{rq}e^q)=m_{st}m_{rq}(e^t.e^q)=m_{st}m_{rq}m^{tq}
$$
so $0=m_{st}(\delta^t{}_r-m_{rq}m^{tq})$ and, as a result, $m_{st}m^{tr}=\delta_s{}^r$.
In other words, the matrices of components $m_{st}=e_s.e_t$ and $m^{tr}=e^t.e^r$ are the inverse of each other.
In the context of abstract simplicial complexes, it is often assumed that the canonical basis $\{e_s:s\in K\}$ of $C$ is orthogonal, so $m_{rs}$ and $m^{rs}$ are the components of diagonal matrices.
Following this trend, in the present work, the trivial inner product $m_{rs}=\delta_{rs}$ is considered.

In differential geometry, an inner product over differencial forms is usually defined in terms of a volume form and an associated Hodge's star operator which in turn depend on a metric tensor.
When a simplicial complex is derived from the discretization of manifold, these constructions can be also available, highlighting the intimate relation between the inner product over chains or cochains, and the geometric properties of simplicial complexes.
In some cases, an hermitian inner product over $\CC$ is preferred.
When this is the case, it can be incorporated into the formalism by the complexification of $C$~\cite{roman2005advanced}.

\subsection{Dual boundaries}

The dual boundary operator $\partial^*:C\to C$ is defined as the inner-product adjoint of the boundary operator $\partial$, i.e. by
$$
\partial^*(c).q = c.\partial(q)
$$
for all $c,q\in C$.
Crucially, $(\partial^*)^2=0$ follows from $\partial^2=0$, and
$$
\partial^*=\partial_0^*+\partial_1^*+...+\partial_n^*
$$
where  $\partial_{-1}^*=\partial_{0}^*=\partial_{n+1}^*=0$ and $\partial_k^*$ is the dual of $\partial_k$, so $\partial_k^*(C)=\partial^*(C_{k-1})\subseteq C_k$.

In matricial form 
$\partial_k^*(e_s) = (\mu_k)_s{}^r e_r$.
Hence,
\begin{eqnarray}
\partial_k^*(e_s).e_r
&=&
e_s.\partial_k(e_r)
\nonumber
\\
(\mu_k)_s{}^t\, e_t.e_r
&=&
(\alpha_k)_r{}^p\, e_s.e_p
\nonumber
\\
(\mu_k)_s{}^t\, m_{tr}
&=&
(\alpha_k)_r{}^p\, m_{sp}
\nonumber
\\
(\mu_k)_s{}^t\, m_{tr}m^{rl}
&=&
(\alpha_k)_r{}^p\, m_{sp}m^{rl}
\nonumber
\\
(\mu_k)_s{}^t\, \delta_t{}^l
&=&
(\alpha_k)_r{}^p\, m_{sp}m^{rl}
\nonumber
\\
(\mu_k)_s{}^l
&=&
m^{lr}\,(\alpha_k)_r{}^p\, m_{ps}
\nonumber
\end{eqnarray}
Moreover, in the particular case where $m_{sr}=\delta_{sr}$, so $m^{sr}=\delta^{sr}$, it is found that $(\mu_k)_s{}^t\delta_{tr}=(\alpha_k)_r{}^p\, \delta_{sp}$, so $(\mu_k)_s{}^r=(\alpha_k)_r{}^s$ and, therefore, $\mu_k=\alpha_k^T$.
Note, $q^re_r=q=\partial_k^*(c)=\partial_k^*(c^se_s)
=c^s\partial_k^*(e_s)=c^s(\mu_k)_s{}^re_r$.
Hence, $q^r=c^s(\mu_k)_s{}^r=(\mu_k^T)^r{}_sc^s=(\alpha_k)^r{}_sc^s$.


\subsection{Dual coboundaries}

The dual coboundary operator $d^*:C^*\to C^*$ is defined as the inner-product adjoint of the coboundary operator $d$, i.e. by
$$
d^*(f).g = f.d(g)
$$
for all $f,g\in C^*$.
The dual coboundary operator is the combinatorial analogous of the codifferential operator.
As before, $(d^*)^2=0$ follows from $d^2=0$, and
$$
d^*=d_0^*+d_1^*+...+d_n^*
$$
where $d_{-1}^*=d_{n}^*=d_{n+1}^*=0$ and $d_k^*$ is the dual of $d_k$, so $d_k^*(C^*)=d^*(C_{k+1}^*)\subseteq C_k^*$.

In matricial form
$d_k^*(e^s)=(\nu_k)^s{}_r e^r$.
Hence
\begin{eqnarray}
d_k^*(e^s).e^r
&=&
e^s.d_k(e^r)
\nonumber
\\
(\nu_k)^s{}_t\,e^t.e^r
&=&
(\beta_k)^r{}_p\,e^s.e^p
\nonumber
\\
(\nu_k)^s{}_t\,m^{tr}
&=&
(\beta_k)^r{}_p\,m^{sp}
\nonumber
\\
(\nu_k)^s{}_t\,m^{tr}m_{rl}
&=&
(\beta_k)^r{}_p\,m^{sp}m_{rl}
\nonumber
\\
(\nu_k)^s{}_t\,\delta^t{}_l
&=&
(\beta_k)^r{}_p\,m^{sp}m_{rl}
\nonumber
\\
(\nu_k)^s{}_l
&=&
m_{lr}\,(\beta_k)^r{}_p\,m^{ps}
\nonumber
\end{eqnarray}
Moreover, in the particular case where $m^{sr}=\delta^{sr}$, so $m_{sr}=\delta_{sr}$, it is found that
$(\nu_k)^s{}_t\delta^{tr}=(\beta_k)^r{}_p\delta^{sp}$, so $(\nu_k)^s{}_r=(\beta_k)^r{}_s$ and, therefore, $\nu_k=\beta_k^T=\alpha_{k+1}$.
Note, $g_re^r=g=d_k^*(f)=d_k^*(f_se^s)
=f_sd_k^*(e^s)=f_s(\nu_k)^s{}_re^r$.
Hence, $g_r=f_s(\nu_k)^s{}_r=(\nu_k^T)_r{}^sf_s=(\beta_k)_r{}^sf_s=(\alpha_{k+1}^T)_r{}^sf_s$.

Note, $\dive = -d_0^*:C_1^*\to C_0^*$ can be recognized as the combinatorial analogous of the divergence of standard differential calculus.

\subsection{Hodge decomposition}

Consider vector spaces $U,V$ and $W$ equipped with an inner product and two linear operator $a:V\to W$ and $b:U\to V$ such that 
\begin{equation}
\label{eqA1}
ab=0
\end{equation}
Then $\rng(b)\subseteq \krn(a)$ follows, enabling the definition of the so called (co)homology group~\footnote{Actually, it is a quotient space. But it can be considered an abelian group under addition.}
\begin{equation}
H:=
\krn(a)/\rng(b)
\cong
\krn(a)\cap \krn(b^*)
\cong
\krn\,L
\nonumber
\end{equation}
whose elements are called (co)homology classes.
Here, $L:=a^*a+bb^*:V\to V$ is called the Hodge Laplacian associated to $a$ and $b$.
It can be shown that
\begin{equation}
\label{eqA2}
V=\rng\,a^*\oplus\krn\,L\oplus\rng\,b
\end{equation}
meaning that, for any vector $v\in V$, there exist the unique decomposition
\begin{equation}
\label{eqA3}
v = a^*(w)+h+b(u)
\end{equation}
for some $w\in W$ and $u\in U$, and where 
$h\in \krn\,L\subseteq V$ is the unique vector of the (co)homology class $[v]\in \krn\,a/\rng\,b$ satisfying $h\in(\rng\,b)^{\perp}=\krn\,b^*$.
For this reason, $h$ is called the harmonic representative of $[v]$.
Equations~\ref{eqA2}~and~\ref{eqA3} represent the so called Hodge decomposition of $V$ and $v$, respectively.
Importantly, $\krn\,b^*=\rng\,a^*\oplus \krn\,L$ and $\krn\,a=\krn\,L\oplus\rng\,b$.
Moreover, $L$ is a positive semidefinite operator since $L=L^*$, and $(a^*a)^*=a^*a$, $(bb^*)^*=bb^*$.
Furthermore, if $[X,Y]:=XY-YX$, then $[L,a^*a]=[L,bb^*]=[a^*a,bb^*]=0$.

\subsection{Homology}

In the context of simplicial complexes, homology emerges from the application of Hodge's decomposition using $\partial_{k}$ and $\partial_{k+1}$ in place of $a$ and $b$ respectively, since $ab=\partial_{k}\partial_{k+1}=0$.
As a result, the Hodge Laplacian takes the form
$$
\mathcal{L}_k
=
\mathcal{L}_k^{\downarrow}
\oplus
\mathcal{L}_k^{\uparrow}
:C_k\to C_k
$$
where
$$
\mathcal{L}_k^{\downarrow}=\partial_{k}^*\partial_{k} : C_k\to C_{k-1}\to C_k
\hspace{1cm}
\mbox{and}
\hspace{1cm}
\mathcal{L}_k^{\uparrow}=\partial_{k+1}\partial_{k+1}^*:C_k\to C_{k+1} \to C_k
$$
so
$$
C_k 
= 
\rng\,\partial_k^*
\oplus
\krn\,\mathcal{L}_k
\oplus
\rng\,\partial_{k+1}
$$
and, therefore, for any $c\in C_k$, there exists unique 
$p\in \rng\,\partial_k^*\subseteq C_k$, $h\in \krn\,\mathcal{L}_k\subseteq C_k$ and $q\in \rng\,\partial_{k+1}\subseteq C_k$
such that $c = p+h+q$.
Importantly, $\krn\,\partial_{k+1}^*=\rng\,\partial_{k}^*\oplus \krn\,\mathcal{L}_k$ and $\krn\,\partial_{k}=\krn\,\mathcal{L}_k\oplus\rng\,\partial_{k+1}$.
Often, $\mathcal{L}_k$, $\mathcal{L}_k^{\downarrow}$ and $\mathcal{L}_k^{\uparrow}$ are called the $k$-th, $k$-th lower and $k$-th upward Laplacians, respectively.
These can be aggregated to obtain a Laplacian over $C$
$$
\mathcal{L} = \partial^*\partial \oplus \partial\partial^* = \mathcal{L}_0\oplus...\oplus \mathcal{L}_n : C\to C
$$
Note, $\mathcal{L}_k^{\downarrow}$ and $\mathcal{L}_k^{\uparrow}$ combine the information of $k$-chains with the information of $(k-1)$-chains and $(k+1)$-chains respectively.

The $k$-th Dirac operator over $C$
$$
\mathcal{D}_k=\partial_k^*+\partial_k
$$
can be also introduced, and it is related to the concept of spinor~\cite{bianconi2021topological}.
It satisfies $\mathcal{D}_k^2=\mathcal{L}_k^{\downarrow}\oplus\mathcal{L}_{k-1}^{\uparrow}$, combining the information between $(k-1)$-chains and $k$-chains.
Similarly, $\mathcal{D}=\partial^*+\partial=\mathcal{D}_0+...+ \mathcal{D}_n$ is such that $\mathcal{D}^2=\mathcal{L}$.

The $k$-th Betti numbers $\beta_k=\rnk\, H_k=\rnk\,\krn \,\partial_k - \rnk\,\rng\,\partial_{k+1}$, which are the ranks of the homology groups, are topological invariants  characterizing the properties of topological spaces.
In the present context where $C$ is a vector space, these homology groups are subspaces, so their ranks are actually their dimensions.

Note, when $m_{rs}$ is the trivial metric $\delta_{rs}$, then $(\mathcal{L}_k^{\downarrow})^s{}_s=(\alpha_k)^s{}_r(\alpha_k^T)^r{}_s=k+1$ is the number of facets of $s$.
Similarly, $(\mathcal{L}_k^{\uparrow})^s{}_s=(\alpha_{k+1}^T)^s{}_r(\alpha_{k+1})^r{}_s=k_s=\zeta_{s,k+1}$ is the number of cofacets or degree of $s$.
For a general metric, $(\mathcal{L}_k^{\downarrow})^s{}_s$ and $(\mathcal{L}_k^{\uparrow})^s{}_s$ represent weighted versions of these quantities.

\subsection{Cohomology\label{appA:cohomology}}

Cohomology emerges from the application of  Hodge decomposition over cochains, using $d_{k}$ and $d_{k-1}$ in place of $a$ and $b$ respectively, so $ab = d_kd_{k-1}=0$.
As a result, the Hodge Laplacian takes the form
$$
L_k
=
L_k^{\uparrow}
\oplus
L_k^{\downarrow}
:C_k^*\to C_k^*
$$
where
$$
L_k^{\uparrow}=d_{k}^*d_{k}:C_k^*\to C_{k+1}^* \to C_k^*
\hspace{1cm}
\mbox{and}
\hspace{1cm}
L_k^{\downarrow}=d_{k-1}d_{k-1}^* : C_k^*\to C_{k-1}^*\to C_k^*
$$
so
$$
C_k^*
=
\rng\,d_k^*
\oplus
\krn\,L_k
\oplus
\rng\,d_{k-1}
$$
and, therefore, for any $f\in C_k^*$, there exists unique 
$s\in \rng\, d_k^*\subseteq C_k^*$,
$h\in \krn\, L_k\subseteq C_k^*$ and
$g\in \rng\, d_{k-1}\subseteq C_k^*$
such that $f = s+h+g$.
Usually, $s$, $h$ and $g$ are called the coexact, harmonic and exact components of $f$ respectively.
Importantly, $\krn\,d_{k-1}^*=\rng\,d_k^*\oplus \krn\,L_k$ and $\krn\,d_k=\krn\,L_k\oplus\rng\,d_{k-1}$.
The Laplacians $L_k^{\uparrow}$ and $L_k^{\downarrow}$ combine the information in $k$-cochains with the information in $(k+1)$-cochains and $(k-1)$-cochains respectively.
Moreover, they can be combined to obtain the so called Hodge Laplacian over $C^*$
$$
L = dd^* \oplus d^*d= L_0\oplus...\oplus L_n : C^*\to C^*
$$
Furthermore, in analogy to its topological counterpart $\mathcal{D}_k$, the $k$-th Dirac operator over cochains
$$
D_k = d_k^*+d_k
$$
can be introduced.
It satisfies $D_k^2=L_k^{\uparrow}\oplus L_{k+1}^{\downarrow}$, combining the information between $k$-cochains and $(k+1)$-cochains.
Correspondingly, $D=d^*+d=D_0+...+ D_n$ is such that $D^2=L$.

The Hodge decomposition of chochains is a generalization of the Helmholtz decomposition of vector calculus in 3D, to arbitrary combinatorial topologies and dimensions.
In fact, the coexact, harmonic and exact componets of the Hodge decomposition are recognized as the solenoid, harmonic and gradient components of the Helmholtz decomposition.
Moreover, $L_0=d_0^*d_0+d_{-1}d_{-1}^*=d_0^*d_0+0=-\dive\circ \grad$ can be recognized as the {\em graph Laplacian}, a combinatorial analogous of the Laplace operator over scalar fields, and $L_1=d_0d_0^*+d_1^*d_1 = \grad\circ \grad^*+\curl^*\circ \curl=-\grad\circ \dive+\curl^*\circ \curl$ can be recognized as the {\em graph Helmholtzian} which is the combinatorial analogous of the vector Laplacian~\cite{lim2020hodge}.
When a simplicial complex is obtained from a discretization of an oriented region in euclidean space, then a Hodge star operator can be defined, relating chains and cochains with volume forms.
In particular, when the triangulation is a 3D-space, then $\curl^*=\curl$ by Hodge duality.
This is the reason for which there is no special name for $\curl^*$ in Physics~\cite{grady2010discrete}.

\end{document}
%
% ****** End of file apstemplate.tex ******


